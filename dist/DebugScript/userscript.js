// ==UserScript==
// @name         DebugScript
// @namespace    https://github.com/LegendaryB/tw-userscripts
// @version      0.1
// @author       LegendaryB
// @match		 https://*.die-staemme.de/game.php*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=die-staemme.de
// @grant        none
// ==/UserScript==

(()=>{"use strict";var e;class t{static registerTranslationProvider(e,t){this.translationProviderMap.set(e,t)}static unregisterTranslationProvider(e){this.translationProviderMap.delete(e)}static getPropertyKeyByHandlebar(e){return e.replace("{{","").replace("}}","")}}e=t,t.translationProviderMap=new Map,t.translate=t=>{let n=e.translationProviderMap.get(window.game_data.locale);return n?n[t]:"ERROR! NO TRANSLATION!"},t.translateAndReplace=t=>{let n=t.match(/{{{?(#[a-z]+ )?[a-z]+.[a-z]*}?}}/gi);if(!n)return t;for(const r of n){let n=e.getPropertyKeyByHandlebar(r),o=e.translate(n);t=t.replace(r,o)}return t},new t;const n=`tw-framework_${window.game_data.world}`;class r{static getItem(e){return e=this.makeKey(e),localStorage.getItem(e)}static setItem(e,t){e=this.makeKey(e),localStorage.setItem(e,t)}static setRawItem(e,t){e=this.makeKey(e);let n=JSON.stringify(t);localStorage.setItem(e,n)}static removeItem(e){e=this.makeKey(e),localStorage.removeItem(e)}static makeKey(e){return`${n}_${e}`}}const o=(e,t)=>e.substring(0,t)+e.charAt(t).toUpperCase()+e.substr(t+1),i=e=>{let t=((e,t)=>{let n=[],r=-1;for(;(r=e.indexOf("_",r+1))>=0;)n.push(r);return n})(e);e=o(e,0);for(const n of t)e=o(e,n+1);return e.replaceAll("_","")};var a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function l(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}c((r=r.apply(e,t||[])).next())}))};const l=(e,t)=>a(void 0,void 0,void 0,(function*(){let n=r.getItem(t);if(n)return JSON.parse(n);let l=yield(e=>a(void 0,void 0,void 0,(function*(){let t=`${new URL(window.location.origin)}/${e}`,n=yield fetch(t);return yield n.text()})))(e),c=(e=>{let t={},n=(new DOMParser).parseFromString(e,"text/xml").querySelector("config");for(const e of n.children){let n=i(o(e.localName,0));if(t[n]={},0!=e.children.length)for(const r of e.children){let e=i(r.localName);t[n][e]=Number(r.innerHTML)}else t[n]=Number(e.innerHTML)}return t})(l);return r.setRawItem(t,c),c}));(async()=>{let e=await a(void 0,void 0,void 0,(function*(){return yield l("interface.php?func=get_unit_info","unitInfo")}));console.log(await a(void 0,void 0,void 0,(function*(){return l("interface.php?func=get_config","worldConfig")}))),console.log(await a(void 0,void 0,void 0,(function*(){return yield l("interface.php?func=get_building_info","buildingInfo")}))),console.log(e),console.log(e.Knight)})()})();